CREATE TABLE inventory_parts (
	id INTEGER PRIMARY KEY AUTOINCREMENT,
	partno TEXT NOT NULL,
	vendor INTEGER NOT NULL,
	type INTEGER NOT NULL,
	UNIQUE(partno,vendor,type)
);

CREATE TABLE IF NOT EXISTS inventory_changes (
	id INTEGER PRIMARY KEY AUTOINCREMENT,
	part_id INTEGER,
	onhand INTEGER NOT NULL,
	t TIMESTAMP DEFAULT CURRENT_TIMESTAMP NOT NULL,
	FOREIGN KEY(part_id) REFERENCES inventory_parts(id)
);

CREATE TABLE IF NOT EXISTS inventory_current (
	partno TEXT NOT NULL PRIMARY KEY,
	onhand INTEGER NOT NULL
);

CREATE INDEX IF NOT EXISTS idx_partid ON inventory_changes(partno);
